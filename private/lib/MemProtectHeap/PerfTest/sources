TARGETNAME=MemProtectHeapPerfTest
TARGETTYPE=PROGRAM
UMENTRY = wmain
UMTYPE = console

USE_NOTHROW_NEW=1
!if defined(_CHAKRA_UCRT_BUILD)
USE_UNICRT=1
USE_MSVCRT=1
!endif

!IF "$(_BUILDARCH)" == "arm" || "$(_BUILDARCH)" == "arm64"
NT_SIGNCODE=1
TEST_CODE=1
!ENDIF

!include $(JSCRIPT_ROOT)\jslibtest.inc

INCLUDES= $(COREINCLUDES);

# Make sure that common.memory.lib is passed to linker prior to msvcrt so that our new/delete
# do not cause 'already defined in msvcrt.lib error'.
CRTLIBS= \
    $(OBJECT_JSCRIPT_DIR)\private\lib\MemProtectHeap\static\$(JS_LIBTYPE)\$(O)\JScript.MemProtectHeap.static.lib

LINKLIBS= \
   $(JS_LIBS_COMMON)

# Libs needed
# oleaut32: Needed for SysAllocString used by CmdParser
# version: Needed by AutoSystemInfo to get version information
# Debug only:
# dbghelp: Needed by Js::Throw::GenerateDump
# user32: Needed by Js::Throw::ReportAssert to show a message box

TARGETLIBS=     \
!if !$(FREEBUILD)
    $(SDK_LIB_PATH)\dbghelp.lib \
    $(MINCORE_PRIV_SDK_LIB_VPATH)\ext-ms-win-ntuser-dialogbox-l1.lib \
!endif
    $(ONECORE_SDK_LIB_VPATH)\onecore.lib \
    $(SDK_LIB_PATH)\ntdll.lib \


SOURCES= \
    MemProtectHeapPerfTest.cpp \
    DefaultResource.rc # Autogenerated file name + version for Device Guard whitelisting effort

# Autogenerated. Sets file name for Device Guard whitelisting effort, used in RC.exe.
C_DEFINES=$(C_DEFINES) -D___TARGETNAME="""$(TARGETNAME).$(TARGETTYPE)"""
MUI_VERIFY_NO_LOC_RESOURCE=1

