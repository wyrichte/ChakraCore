<html>
<meta http-equiv="X-UA-Compatible" content="IE=8">
<script>

var write = function(value) { document.write(value + "<br>"); }

var errorCount = 0;

function verify(scen, exp, act)
{
	if (act !== exp)
	{
		write("Failed " + scen + ": Exp= " + exp + " . Act= " + act);
		errorCount++;
	}
	else
	{
		//write("Passed " + scen);
	}
}


//-----------------
write("Testing enumerator over ActivexObject");


var dict = new ActiveXObject("Scripting.Dictionary");
dict.Add("100", "one");
dict.Add("200", "twwo");

var enumDict = new Enumerator(dict);

verify("Activex Dict 1", false, enumDict.atEnd());
verify("Activex Dict 2", "100", enumDict.item());

verify("Activex Dict 3", "100", enumDict.item());
verify("Activex Dict 4", undefined, enumDict.moveNext());
verify("Activex Dict 5", false, enumDict.atEnd());

verify("Activex Dict 6", "200", enumDict.item());
verify("Activex Dict 7", undefined, enumDict.moveNext());
verify("Activex Dict 8", true, enumDict.atEnd());

verify("Activex Dict 9", undefined, enumDict.item());
verify("Activex Dict 10", undefined, enumDict.moveNext());
verify("Activex Dict 11", true, enumDict.atEnd());

verify("Activex Dict 12", undefined, enumDict.moveFirst());

verify("Activex Dict 13", false, enumDict.atEnd());

verify("Activex Dict 14", "100", enumDict.item());
verify("Activex Dict 15", undefined, enumDict.moveNext());
verify("Activex Dict 16", false, enumDict.atEnd());

verify("Activex Dict 17", "200", enumDict.item());
verify("Activex Dict 18", undefined, enumDict.moveNext());
verify("Activex Dict 19", true, enumDict.atEnd());

verify("Activex Dict 20", undefined, enumDict.item());
verify("Activex Dict 21", undefined, enumDict.moveNext());
verify("Activex Dict 22", true, enumDict.atEnd());


//-----------------
write("Testing enumerator over Arrays");

Array.prototype.ap1 = "Array.Proto.1";
var arr = new Array(10,20);
arr.x = "arr.x";

var enumArr = new Enumerator(arr);

verify("Array 1", false, enumArr.atEnd());
verify("Array 2", 10, enumArr.item());

verify("Array 3", 10, enumArr.item());
verify("Array 4", undefined, enumArr.moveNext());
verify("Array 5", false, enumArr.atEnd());

verify("Array 6", 20, enumArr.item());
verify("Array 7", undefined, enumArr.moveNext());
verify("Array 7.1", false, enumArr.atEnd());

verify("Array 7.2", "arr.x", enumArr.item());
verify("Array 7.3", undefined, enumArr.moveNext());
verify("Array 7.4", false, enumArr.atEnd());

verify("Array 7.5", "Array.Proto.1", enumArr.item());
verify("Array 7.6", undefined, enumArr.moveNext());
verify("Array 7.7", true, enumArr.atEnd());

verify("Array 9", undefined, enumArr.item());
verify("Array 10", undefined, enumArr.moveNext());
verify("Array 11", true, enumArr.atEnd());

verify("Array 12", undefined, enumArr.moveFirst());

verify("Array 13", false, enumArr.atEnd());

verify("Array 14", 10, enumArr.item());
verify("Array 15", undefined, enumArr.moveNext());
verify("Array 16", false, enumArr.atEnd());

verify("Array 17", 20, enumArr.item());
verify("Array 18", undefined, enumArr.moveNext());
verify("Array 19.1", false, enumArr.atEnd());

verify("Array 19.2", "arr.x", enumArr.item());
verify("Array 19.3", undefined, enumArr.moveNext());
verify("Array 19.4", false, enumArr.atEnd());

verify("Array 19.5", "Array.Proto.1", enumArr.item());
verify("Array 19.6", undefined, enumArr.moveNext());
verify("Array 19.7", true, enumArr.atEnd());

verify("Array 20", undefined, enumArr.item());
verify("Array 21", undefined, enumArr.moveNext());
verify("Array 22", true, enumArr.atEnd());

//-----------------
write("Testing enumerator with No arguments to it");

var enumArr = new Enumerator();

verify("No arguments 1", true, enumArr.atEnd());
verify("No arguments 2", undefined, enumArr.item());

verify("No arguments 3", undefined, enumArr.item());
verify("No arguments 4", undefined, enumArr.moveNext());
verify("No arguments 5", true, enumArr.atEnd());

verify("No arguments 6", undefined, enumArr.moveFirst());

verify("No arguments 7", true, enumArr.atEnd());
verify("No arguments 8", undefined, enumArr.item());

verify("No arguments 9", undefined, enumArr.item());
verify("No arguments 10", undefined, enumArr.moveNext());
verify("No arguments 11", true, enumArr.atEnd());

function doEval(str, exp) {
	var actual = "This is what will not print!!";
	try {
		actual = eval(str) + "";
	} catch (e) {
		actual = e.message;
	}
	verify(str, exp, actual);	
}

//-----------------
write("Testing enumerator methods over Enumerator object");

Enumerator.prototype.oString = Object.prototype.toString;

var enumTemp = new Enumerator([10,20,30,40,50]);

doEval("Enumerator.prototype.item.apply(enumTemp)", "10");
doEval("Enumerator.prototype.moveNext.apply(enumTemp)", "undefined");
doEval("Enumerator.prototype.moveFirst.apply(enumTemp)", "undefined");
doEval("Enumerator.prototype.atEnd.apply(enumTemp)", "false");

verify("Enumerator.oString()", "[object Object]", enumTemp.oString());

//-----------------
write("Testing enumerator methods over other objects");

doEval("Enumerator.prototype.item.call()", "Enumerator object expected");
doEval("Enumerator.prototype.item.call(10)", "Enumerator object expected");

doEval("Enumerator.prototype.moveNext.call()", "Enumerator object expected");
doEval("Enumerator.prototype.moveNext.call(10)", "Enumerator object expected");

doEval("Enumerator.prototype.moveFirst.call()", "Enumerator object expected");
doEval("Enumerator.prototype.moveFirst.call(10)", "Enumerator object expected");

doEval("Enumerator.prototype.atEnd.call()", "Enumerator object expected");
doEval("Enumerator.prototype.atEnd.call(10)", "Enumerator object expected");

doEval("Enumerator.prototype.item.apply()", "Enumerator object expected");
doEval("Enumerator.prototype.item.apply(10)", "Enumerator object expected");

doEval("Enumerator.prototype.moveNext.apply()", "Enumerator object expected");
doEval("Enumerator.prototype.moveNext.apply(10)", "Enumerator object expected");

doEval("Enumerator.prototype.moveFirst.apply()", "Enumerator object expected");
doEval("Enumerator.prototype.moveFirst.apply(10)", "Enumerator object expected");

doEval("Enumerator.prototype.atEnd.apply()", "Enumerator object expected");
doEval("Enumerator.prototype.atEnd.apply(10)", "Enumerator object expected");




if (errorCount)
{
	write(errorCount + " test(s) failed!!!!!!!!!!!!!.");
	throw new Error(errorCount + " test(s) failed.");
}


</script>

</html>
    