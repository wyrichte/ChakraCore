TEST_CODE=1

!include $(INETCORE_DIR)\ieunittest.inc

# Don't disable warnings
MSC_WARNING_LEVEL=/W4 /WX

DLLDEF=
TARGETTYPE=DYNLINK
TARGETNAME=ut_jscript
USE_STL=1
USE_ATL=1
USE_RTTI=1

# Turns on fretest for test code
!include $(JSCRIPT_ROOT)\jslibtest.inc

C_DEFINES =$(C_DEFINES) -DWINNT -DUNICODE -D_UNICODE

INCLUDES= \
          $(INCLUDES);    \
          $(COREINCLUDES); \
          ..\..\private\lib\Telemetry; \
          $(SDK_INC_PATH)\crt\stl70; \
          $(SDK_INC_PATH)\atl30; \
          $(SDKTOOLS_INC_PATH)\WexTest\Cue; \

PRECOMPILED_INCLUDE=stdafx.h
PRECOMPILED_SOURCEFILE=stdafx.cpp
PRECOMPILED_CXX=1

LINKLIBS= \
!IF (!$(FREEBUILD) || defined(FRETEST) || defined(NTTESTENV)) && "$(TARGET_DIRECTORY)" != "arm" && "$(TARGET_DIRECTORY)" != "arm64"
    ..\..\tools\external\lib\$(TARGET_DIRECTORY)\jitprofiling.lib \
!ENDIF
    $(ONECOREUAPSHELL_LIB_PATH)\commonutilitylibrary.lib       \
    $(OBJECT_JSCRIPT_DIR)\private\core_razzle_build\common\codex\$(O)\chakra.common.codex.lib \
    $(PROJECT_LIB_PATH)\iertutilp.lib \
    $(PROJECT_LIB_PATH)\IESettingsId.lib \
    $(PROJECT_LIB_PATH)\IESettingsApi.lib \
    $(JS_LIBS_COMMON) \

TARGETLIBS=     \
    $(ONECORE_PRIV_SDK_LIB_PATH)\OneCore_Forwarder_kernel32.lib \
    $(ONECORE_PRIV_SDK_LIB_PATH)\OneCore_Forwarder_advapi32.lib \
    $(MINCORE_PRIV_SDK_LIB_VPATH)\mincore_private.lib \
    $(SDK_LIB_PATH)\oleaut32.lib \
    $(SDK_LIB_PATH)\muiload.lib \
    $(SDK_LIB_PATH)\ntdll.lib \
    $(ONECORE_PRIV_SDK_LIB_PATH)\OneCore_Forwarder_ole32.lib \
    $(ONECORE_PRIV_SDK_LIB_PATH)\OneCore_Forwarder_version.lib \
    $(ONECORE_SDK_LIB_VPATH)\onecore.lib \
!if !$(FREEBUILD)
    $(SDK_LIB_PATH)\dbghelp.lib \
    $(ONECORE_PRIV_SDK_LIB_PATH)\OneCore_Forwarder_user32.lib \
    $(MINCORE_PRIV_SDK_LIB_VPATH)\ext-ms-win-ntuser-dialogbox-l1.lib \
!endif
    $(SDKTOOLS_LIB_PATH)\WexTest\Cue\Wex.Common.lib \
    $(SDKTOOLS_LIB_PATH)\WexTest\Cue\Wex.Logger.lib \

DELAYLOAD = $(DELAYLOAD) \
!IF (!$(FREEBUILD))
    ext-ms-win-ntuser-dialogbox-l1-1-0.dll; \
!ENDIF

ALLOW_NT_STYLE_DLOAD_ERROR_HANDLER=1
DLOAD_ERROR_HANDLER=kernelbase.dll

SOURCES= \
    dllmain.cxx \
    allocatorTest.cxx   \
    tests.cxx \
    CustomHeapTests.cpp \
    DefaultResource.rc # Autogenerated file name + version for Device Guard whitelisting effort

# Autogenerated. Sets file name for Device Guard whitelisting effort, used in RC.exe.
C_DEFINES=$(C_DEFINES) -D___TARGETNAME="""$(TARGETNAME).$(TARGETTYPE)"""
MUI_VERIFY_NO_LOC_RESOURCE=1
